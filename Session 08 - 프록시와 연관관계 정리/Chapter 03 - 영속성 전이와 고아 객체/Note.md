# 영속성 전이(CASCADE)와 고아 객체
> 작성자: @asas6978

## 목차
- **영속성 전이: CASCADE**
- **고아 객체**
- **영속성 전이 + 고아 객체, 생명주기**

## 영속성 전이: CASCADE
### CASCADE
특정 엔티티를 영속 상태로 만들 때 연관된 엔티티도 함께 영속 상태로 만들고 싶을 때 이용

### 저장
<img width="400" alt="image" src="https://github.com/luke0408/study_for_jpa_basic/assets/77332981/53829f3f-a1c0-4f58-bf1b-735f09887163">


### 주의점
- 영속성 전이는 지연로딩/즉시로딩 및 연관관계와 전혀 관련이 없음, 엔티티를 영속화할 때 연관된 엔티티도 함께 영속화하는 편리함을 제공하는 수단에 불과함
- 하나의 부모가 자식을 관리할 때가 아닌 다른 엔티티와 연관관계가 있을 경우에는 쓰면 안됨
  

### 종류
- ALL
- PERSIST
- REMOVE
- MERGE
- REFRESH
- DETACH
  

## 고아 객체
### 고아객체란?
- 연관된 엔티티를 제거할 때, 해당 엔티티와의 연관관계를 끊어주지 않으면 고아 객체가 발생하게 됨
- 고아 객체를 제거한다는 것은 부모 엔티티와 연관관계가 끊어진 자식 엔티티를 자동으로 삭제한다는 것을 의미
  

### 주의점
- 고아 객체 제거는 참조가 제거된 엔티티의 경우 다른 곳에서 참조하지 않는 고아 객체로 보고 삭제하는 기능
- 참조하는 곳이 하나일 때만 사용해야 함
  - 연관 관계에 있는 다른 엔티티에서 해당 엔티티를 참조하고 있다면, 고아 객체 제거를 통해 삭제하면 데이터 무결성을 해치게 될 수 있음
    

## 영속성 전이 + 고아 객체, 생명주기
- `CascadeType.ALL + orphanRemoval=true`를 통해 활성화
- 스스로 생명주기를 관리하는 엔티티는 `persist()`로 영속화하며, `remove()`로 제거
- 두 옵션을 모두 활성화 하면 부모 엔티티를 통해서 자식의 생명주기 관리 가능
