# 경로 표현식
> 작성자: @destiny3912

## 목차
- [경로 표현식](#경로-표현식)
  - [목차](#목차)
    - [1. 용어 정리](#1-용어-정리)
    - [2. 경로 표현식 특징](#2-경로-표현식-특징)
    - [3. 명시적 조인과 묵시적 조인](#3-명시적-조인과-묵시적-조인)
    - [4. 예제](#4-예제)
    - [5. 묵시적 조인 시 주의 사항](#5-묵시적-조인-시-주의-사항)

    
### 1. 용어 정리
- 상태 필드
    - 단순히 값을 저장하기 위한 필드
- 연관 필드
    - 연관 관계를 위한 필드
        - 단일
            - @XToOne → 대상이 엔티티이다
        - 컬렉션
            - @XTomany → 대상이 컬렉션
  
![image](https://github.com/luke0408/study_for_jpa_basic/assets/74547868/5877c937-26a1-4db6-81ee-a6cef01eb48d)


### 2. 경로 표현식 특징
- 상태 필드 → 경로 탐색의 끝, 그 이상 탐색이 불가함
        
    ```sql
    select m.username from Member m;
    ```
        
 - 단일 값 연관 경로 → 묵시적 내부 조인(inner join) → 탐색 가능
        
    ```sql
    select  m.team from Member m;
    ```
        
    - 묵시적 조인이 발생 하므로 쿼리 튜닝 할때 힘들다
- 컬렉션 값 연관 경로 → 묵시적 내부 조인 → 탐색 불가 (컬렉션 타입으로 가져오기 때문이다)
        
    ```sql
    select t.members from Team t;
    ```
        
    - from 절에서 명시적 조인을 통해 별칭을 얻으면
    - 그 별칭을 통해 탐색이 가능
- 중요! → 묵시적 조인은 절대 쓰지 말라

### 3. 명시적 조인과 묵시적 조인
- 명시적 조인
    - join 절을 명시적으로 사용해 조인
    - join 유형을 지정해 조인이 가능
    - join 조건이 명확함
- 묵시적 조인
    - 경로 표현식에서 파생되는 자동 조인
    - 코드는 간결해 지지만 조인이 어디서 나오는지 표시가 되지않음
    - 따라서 쿼리 튜닝에 불리함
    - 또한 inner join만 가능
### 4. 예제
    
```sql
select o.member.team from Order o;
```
    
- 성공
- 다만 조인이 2번 나간다
    
```sql
select t.members from Team;
```
    
- 성공
- 추가 탐색이 없기 때문
    
```sql
select t.members.username from Team t;
```
    
- 실패
- 묵시적 조인에서 추가 탐색을 시도
    
```sql
select m.username from Team t join t.members m;
```
    
- 성공
 - 명시적 조인에서 추가 탐색 가능
  
### 5. 묵시적 조인 시 주의 사항
- 항상 inner join으로 조인된다
- 컬렉션은 경로 탐색의 끝이며
- 명시적 조인을 통해 별칭을 얻어야 추가 탐색이 가능하다
- 경로 탐색은 주로 select, where 절에서 사용하지만 묵시적 조인으로 인해 SQL의 FROM (JOIN) 절에 영향을 줌
- 실무에서는?
  - 가급적 명시적 조인을 사용하라
  - 조인은 SQL 튜닝에서 가장 중요한 부분이다
  - 묵시적 조인은 일어나는 상황을 한 눈에 파악하기 어려움